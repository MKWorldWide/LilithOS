default_platform(:ios)

platform :ios do
  desc "Build and upload to TestFlight"
  lane :beta do
    build_app(
      scheme: "LilithOS",
      export_method: "app-store"
    )
    upload_to_testflight(
      username: ENV["FASTLANE_USER"],
      app_identifier: ENV["FASTLANE_APP_IDENTIFIER"],
      app_platform: "ios",
      skip_waiting_for_build_processing: true,
      skip_submission: true,
      skip_app_version_update: true,
      app_store_connect_api_key: {
        key_id: ENV["APPSTORE_API_KEY_ID"],
        issuer_id: ENV["APPSTORE_ISSUER_ID"],
        key_filepath: ENV["APPSTORE_API_KEY_PATH"]
      },
      app_review_information: {
        notes: "Automated upload via Fastlane."
      },
      shared_secret: ENV["APPSTORE_SHARED_SECRET"]
    )
  end
end 